<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
  </head>

  <div class="card">
    <div class="card-body">
      <div class="card card-primary">
          <form [formGroup]="accountForm" (ngSubmit)="submit()">
            <div class="card-body">
              <div class="form-group" data-select2-id="29">
                  <label>Account Type</label>
                  <select id="accountType" class="form-control select2 select2-hidden-accessible"
                  style="width: 100%;" data-select2-id="1" tabindex="-1" aria-hidden="true" name="accountType"
                  (change)="changeType($event)" formControlName="accountType">
                    <option selected="selected" data-select2-id="3" disabled>Select Account Type</option>
                    <option *ngFor="let account of accounts" [ngValue]=account>
                      {{ account }} </option>
                  </select>
                  <small *ngIf="accountType?.errors && accountType.touched" class="text-danger">Account type is required</small>
              </div>

              <div class="form-group">
                <label for="firstName">Account Nickname</label>
                <input [class.is-invalid] = "accountForm.get('nickName')?.invalid && accountForm.get('nickName')?.touched"
                id="nickName" class="form-control" type="text"
                placeholder="Account Nickname" name="nickName" formControlName = "nickName">
                <small *ngIf="nickName?.errors && nickName.touched" class="text-danger">Nickname needs to be 4-20 alphanumeric characters</small>
            </div>

              <div class="form-group">
                <small *ngIf="(acctService.creationError)" class="text-danger">
                  Please verify User account numbers</small>
                  <label for="users">Add Users</label>

                  <br>
                  <input type="text" id="userSearch" >
                  <button type="button" class="btn btn-primary btn-sm" (click)="searchUsers()" >Find Users</button>
                  <!--button type="button" class="btn btn-danger btn-sm" (click)="closeUsers()" *ngIf="searchUsers">Close Results</button-->

                  <ul class="list-group list-group-flush">
                  <div *ngIf= "userSearch?.length ==0"> No users found</div>
                  <!--section *ngFor="let user of userSearch; let i = index;">
                    <div *ngIf="i<5">
                    <li class="list-group-item">
                      {{user.firstName}} {{user.lastName}} - {{user.username}} - {{user.email}} - {{user.id}}
                      <span class="pull-right"><i center="right" class ='fa fa-plus' (click)="addUserNew(user)"></i></span>
                    </li>
                    </div>
                  </section-->
                  </ul>

                  <br>
                  <section *ngFor="let user of usersOnAccount; let i = index;">
                    <div *ngIf="i<5">
                    <li class="list-group-item">
                      {{user.firstName}} {{user.lastName}} - {{user.username}} - {{user.email}} - {{user.id}}
                      <span class="pull-right"><i center="right" class ='fa fa-minus' (click)="removeUserNew(i)"></i></span>
                    </li>
                    </div>
                  </section>
<!--
                  <small *ngIf="accountForm.get('users')?.invalid && accountForm.get('users')?.touched" class="text-danger">All users must be listed as ID number</small>
                  <span class="pull-right"><i center="right" class ='fa fa-plus' (click)="addUser()"></i></span>
                  <div class="input-group" formArrayName="users">
                  <ul class="list-group list-group-flush">
                  <section *ngFor="let user of users().controls; let i = index;" [formGroupName]="i">
                    <li class="list-group-item">
                    <input [class.is-invalid] = "accountForm.get('users')?.invalid && accountForm.get('users')?.touched"
                    id="user" class="form-control" type="text" pattern="^[0-9]{1,15}$"
                    placeholder="Users on Account" name="user_{{i}}" formControlName="user">
                    <button type="button" class="btn btn-danger btn-sm" (click)="removeUser(i)"  *ngIf="i !== 0">Remove User</button>
                  </li>
                  </section>
                  </ul>
                  </div>-->
              </div>

              <div class="form-group">
                <label for="exampleInputFile">File input</label>
                <div class="input-group">
                  <div class="custom-file">
                    <input type="file" class="custom-file-input" id="exampleInputFile">
                    <label class="custom-file-label" for="exampleInputFile">Choose file</label>
                  </div>
                  <div class="input-group-append">
                    <span class="input-group-text">Upload</span>
                  </div>
                </div>
              </div>

            <!-- /.card-body -->
          </div>

        <div class="card-footer">

          <button type="button" class="btn btn-primary" [disabled]="(usersOnAccount.length<1) || (!accountForm.valid)" [type]="'submit'">New Account</button>

        </div>

      </form>

</div>

<div class="left">
  <router-outlet></router-outlet>
  <br />
  <br />
  <a routerLink="/accounts">View all accounts</a>
</div>

